import React, { useState } from 'react';
import { Eye, CodeXml } from 'lucide-react';

interface TextareaProps {
  content: string | null | undefined;
}

const HtmlViewer: React.FC<TextareaProps> = ({ content }) => {
  const uid = (Math.random() + 1).toString(36).substring(7);
  const [showSource, setShowSource] = useState(false);
  return (
    <div>
      <div>
        <button
          onClick={() => setShowSource(!showSource)}
          className="inline-flex gap-1 bg-slate-200 text-slate-900 dark:bg-gray-800 dark:text-gray-300 p-1 mb-2 rounded-full cursor-pointer hover:bg-slate-300 dark:hover:bg-gray-700 transition-colors"
        >
          <Eye
            size={24}
            className={`rounded-full ${!showSource ? 'bg-white text-neutral-800 dark:bg-black' : ''} dark:text-neutral-200 hover:text-black hover:dark:text-white p-1`}
          />
          <CodeXml
            size={24}
            className={`rounded-full ${showSource ? 'bg-white text-neutral-800 dark:bg-black' : ''} dark:text-neutral-200 hover:text-black hover:dark:text-white p-1`}
          />
        </button>
      </div>
      {showSource && (
        <div className="bg-black text-lime-500 p-2 rounded-md  font-mono text-sm">
          <textarea className="code w-full min-h-[300px] focus:outline-none">{content}</textarea>
        </div>
      )}
      {!showSource && (
        <>
          <div
            id={`pn-htmlviewer-${uid}`}
            className="p-2 rounded-lg bg-neutral-100 text-black dark:bg-black dark:text-white rounded-lg"
            dangerouslySetInnerHTML={{ __html: content || '' }}
          ></div>
          <style>{`
          .code {
  counter-reset: linenumber;
  font-family: monospace;
}

.code {
  white-space: pre;
}

.code::before {
  counter-increment: linenumber;
}

.code {
  display: block;
}

.code span {
  display: block;
  counter-increment: linenumber;
}

.code span::before {
  content: counter(linenumber);
  color: #999;
  display: inline-block;
  width: 2em;
  text-align: right;
  margin-right: 1em;
}
        #pn-htmlviewer-${uid} {
          padding: 1rem;
          border-radius: 0.375rem;
        }
        #pn-htmlviewer-${uid} table,
        #pn-htmlviewer-${uid} th,
        #pn-htmlviewer-${uid} td {
          border: 1px solid;
        }
        #pn-htmlviewer-${uid} h1 {
          font-size: 2rem !important;
          font-weight: 700 !important;
          line-height: 1.2 !important;
          margin: 1.5rem 0 0.75rem 0 !important;
        }

        #pn-htmlviewer-${uid} h2 {
          font-size: 1.5rem !important;
          font-weight: 600 !important;
          line-height: 1.3 !important;
          margin: 1.25rem 0 0.5rem 0 !important;
        }

        #pn-htmlviewer-${uid} h3 {
          font-size: 1.25rem !important;
          font-weight: 600 !important;
          line-height: 1.4 !important;
          margin: 1rem 0 0.5rem 0 !important;
        }

        #pn-htmlviewer-${uid} p {
          margin: 0.75rem 0 !important;
          line-height: 1.6 !important;
        }

        #pn-htmlviewer-${uid} strong {
          font-weight: 700 !important;
        }

        #pn-htmlviewer-${uid} em {
          font-style: italic !important;
        }

        #pn-htmlviewer-${uid} ul {
          list-style-type: disc !important;
          margin: 1rem 0 !important;
          padding-left: 2rem !important;
        }

        #pn-htmlviewer-${uid} ol {
          list-style-type: decimal !important;
          margin: 1rem 0 !important;
          padding-left: 2rem !important;
        }

        #pn-htmlviewer-${uid} li {
          margin: 0.25rem 0 !important;
          line-height: 1.6 !important;
        }

        #pn-htmlviewer-${uid} a {
          color: #3b82f6 !important;
          text-decoration: underline !important;
        }

        #pn-htmlviewer-${uid} a:hover {
          color: #2563eb !important;
        }

        #pn-htmlviewer-${uid} img {
          max-width: 100% !important;
          height: auto !important;
          margin: 1rem 0 !important;
          border-radius: 0.375rem !important;
        }

        #pn-htmlviewer-${uid} blockquote {
          border-left: 4px solid #e5e7eb !important;
          margin: 1.5rem 0 !important;
          padding: 0.5rem 0 0.5rem 1rem !important;
          font-style: italic !important;
        }

      `}</style>
        </>
      )}
    </div>
  );
};

export default HtmlViewer;
