import { useKeycloak } from '@react-keycloak/web';

export function useUserAutenticatedHelper() {
  const { keycloak, initialized } = useKeycloak();
  const getTokenParsed = () => keycloak.tokenParsed;
  const getUsername = () => keycloak.tokenParsed?.preferred_username;
  const hasRole = (role: string) => keycloak.hasResourceRole(role);
  const isAutenticated = () => keycloak.authenticated;
  const isInitialized = () => initialized;
  const login = (args?: object) => keycloak.login(args);
  const logout = (args?: object) => keycloak.logout(args);
  return {
    getTokenParsed,
    getUsername,
    hasRole,
    isAutenticated,
    isInitialized,
    login,
    logout,
  };
}
